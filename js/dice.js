/*
* grrd's Dice
* Copyright (c) 2015 Gerard Tyedmers, grrd@gmx.net
* Licensed under the MPL License
*/
!function(){"use strict";function a(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b="[\\?&]"+a+"=([^&#]*)",c=new RegExp(b),d=c.exec(window.location.href);return null!==d?d[1]:!1}function b(){var a;if(!pa||!aa){for(Pa.popup("close"),Qa.popup("close"),Ea.hide(),Ca.hide(),a=0;oa>a;a+=1)ca[a]||(O[a]=Math.round((O[a]+30*Math.random()-15)/Math.PI*2)*Math.PI/2,R[a]=Math.round((R[a]+30*Math.random()-15)/Math.PI*2)*Math.PI/2,U[a]=Math.round((U[a]+30*Math.random()-15)/Math.PI*2)*Math.PI/2);aa=!0}}function c(){var a,b;if(ka=$(window).height(),la=$(window).width(),za=window.innerWidth/2,Aa=window.innerHeight/2,ka>la){if(ja=ka/7,Ia.attr("style","position:absolute; top:"+(Aa-2.4*ja)+"px; left:"+(za-1.4*ja)+"px; pointer-events:none; width:"+ja+"px; height:"+ja+"px; display:"+$("#img_lock3").css("display")),Fa.attr("style","position:absolute; top:"+(Aa-2.4*ja)+"px; left:"+(za+.4*ja)+"px; pointer-events:none; width:"+ja+"px; height:"+ja+"px; display:"+$("#img_lock0").css("display")),Ha.attr("style","position:absolute; top:"+(Aa-ja/2)+"px; left:"+(za-ja/2)+"px; pointer-events:none; width:"+ja+"px; height:"+ja+"px; display:"+$("#img_lock2").css("display")),Ja.attr("style","position:absolute; top:"+(Aa+1.3*ja)+"px; left:"+(za-1.4*ja)+"px; pointer-events:none; width:"+ja+"px; height:"+ja+"px; display:"+$("#img_lock4").css("display")),Ga.attr("style","position:absolute; top:"+(Aa+1.3*ja)+"px; left:"+(za+.4*ja)+"px; pointer-events:none; width:"+ja+"px; height:"+ja+"px; display:"+$("#img_lock1").css("display")),$("#img_title").attr("style","width:100%;margin-top:-10px;"),$("#img_title2").attr("style","width:100%;margin-top:-20px;"),$("#img_title3h").show(),$("#img_title3q").hide(),La.css({width:"100%",position:"absolute",bottom:"0","margin-bottom":"16px"}),Ma.css({width:la/2-16+"px",height:""}),Oa.css({width:la/2-16+"px",height:""}),$("#bt_dice_pad").attr("style",""),$("#bt_yahtzee_pad").attr("style",""),void 0!==N[0]&&null!==N[0])switch(oa){case 1:N[0].position.set(0,0,0),E.position.set(0,0,2.2);break;case 2:N[0].position.set(0,.45,0),N[1].position.set(0,-.45,0),E.position.set(0,0,3);break;case 3:N[0].position.set(0,.9,0),N[1].position.set(0,0,0),N[2].position.set(0,-.9,0),E.position.set(0,0,4.2);break;case 4:N[0].position.set(.45,.45,0),N[1].position.set(-.45,.45,0),N[2].position.set(.45,-.45,0),N[3].position.set(-.45,-.45,0),E.position.set(0,0,4.2);break;case 5:N[0].position.set(.45,.9,0),N[1].position.set(.45,-.9,0),N[2].position.set(0,0,0),N[3].position.set(-.45,.9,0),N[4].position.set(-.45,-.9,0),E.position.set(0,0,5.6)}}else if(ja=ka/6,Ia.attr("style","position:absolute; top:"+(Aa-1.7*ja)+"px; left:"+(za-2.8*ja)+"px; pointer-events:none; width:"+ja+"px; height:"+ja+"px; display:"+$("#img_lock3").css("display")),Fa.attr("style","position:absolute; top:"+(Aa-1.7*ja)+"px; left:"+(za+1.8*ja)+"px; pointer-events:none; width:"+ja+"px; height:"+ja+"px; display:"+$("#img_lock0").css("display")),Ha.attr("style","position:absolute; top:"+(Aa-ja/2)+"px; left:"+(za-ja/2)+"px; pointer-events:none; width:"+ja+"px; height:"+ja+"px; display:"+$("#img_lock2").css("display")),Ja.attr("style","position:absolute; top:"+(Aa+.6*ja)+"px; left:"+(za-2.8*ja)+"px; pointer-events:none; width:"+ja+"px; height:"+ja+"px; display:"+$("#img_lock4").css("display")),Ga.attr("style","position:absolute; top:"+(Aa+.6*ja)+"px; left:"+(za+1.8*ja)+"px; pointer-events:none; width:"+ja+"px; height:"+ja+"px; display:"+$("#img_lock1").css("display")),$("#img_title").attr("style","width:calc(46% - 15px);margin-bottom:20px;"),$("#img_title2").attr("style","width:calc(31% - 10px);margin-top:0px;margin-bottom:20px;margin-left:20px;"),$("#img_title3h").hide(),$("#img_title3q").show(),La.css({width:"100%",position:"absolute","margin-bottom":(ka-.2*la-100)/3.5+"px",bottom:"0"}),Ma.css({width:la/2-16+"px",height:Math.max((ka-.2*la-100)/2,40)+"px"}),Oa.css({width:la/2-16+"px",height:Math.max((ka-.2*la-100)/2,40)+"px"}),$("#bt_dice_pad").attr("style","padding-top:"+Math.max((ka-.2*la-200)/4,0)+"px;"),$("#bt_yahtzee_pad").attr("style","padding-top:"+Math.max((ka-.2*la-200)/4,0)+"px;"),void 0!==N[0]&&null!==N[0])switch(oa){case 1:N[0].position.set(0,0,0),E.position.set(0,0,1.8);break;case 2:N[0].position.set(.45,0,0),N[1].position.set(-.45,0,0),E.position.set(0,0,2.2);break;case 3:N[0].position.set(.9,0,0),N[1].position.set(0,0,0),N[2].position.set(-.9,0,0),E.position.set(0,0,3);break;case 4:N[0].position.set(.45,.45,0),N[1].position.set(-.45,.45,0),N[2].position.set(.45,-.45,0),N[3].position.set(-.45,-.45,0),E.position.set(0,0,3);break;case 5:N[0].position.set(.9,.45,0),N[1].position.set(.9,-.45,0),N[2].position.set(0,0,0),N[3].position.set(-.9,.45,0),N[4].position.set(-.9,-.45,0),E.position.set(0,0,4)}for(Pa.css("max-width",la-10+"px"),Qa.css("max-width",la-10+"px"),Ra.css("max-width",la-10+"px"),Sa.css("max-width",la-40+"px"),$("#start").css("width",la-30+"px"),a=1;6>a;a+=1)$("#radio"+a).attr("style","width:"+(la-50)/5.3+"px; max-width: 92px;height:"+(la-50)/5.3+"px; max-height: 92px;"),$("#img_color"+a).css({"max-width":"80px",width:(la-90)/5.5+"px"}),$("#img_anz"+a).width((la-10)/5+"px");b=$(".w16"),b.width(Math.min((la-40)/6.2,80)+"px"),b.height(Math.min((la-40)/6.2,80)+"px"),setTimeout(function(){b.width(Math.min((la-40)/6.2,80)+"px"),b.height(Math.min((la-40)/6.2,80)+"px")},500)}function d(a){var b;if(X=a.clientX-za,Z=a.clientY-Aa,!pa||!aa)for(b=0;oa>b;b+=1)ca[b]||(O[b]=P[b]+.08*(X-Y)*Q[b],R[b]=S[b]+.08*(Z-_)*T[b],U[b]=V[b]+(.08*(X-Y)*W[b]+.08*(Z-_)*W[b])/2)}function e(){var a,b,c,d,e=0;for(a=0;a<ea.length;a+=1)ea[a]=0;for(a=0;a<da.length;a+=1){if(ea[a]=da[a]*(a+1),da[a]>=3&&(ea[7]=3*(a+1)),da[a]>=4&&(ea[8]=4*(a+1)),da[a]>=5&&(ea[12]=50),da[a]>=5&&(ea[9]=25),3===da[a])for(b=0;b<da.length;b+=1)2===da[b]&&(ea[9]=25);da[a]>=1?e+=1:e=0,e>=4&&(ea[10]=30),e>=5&&(ea[11]=40)}for(ea[13]=ga,a=0;a<ea.length;a+=1)null===fa[ta-1][a]&&(c=$("#bt_"+a+"p"+ta),$("#lb_"+a+"p"+ta).css("display","none"),c.css("display","block"),d=$("#bt_"+a+"p"+ta+" .ui-btn-text"),d.length?d.text(ea[a]):c.html(ea[a]));Ka.hide(),$.mobile.changePage("#popup_yahtzee",{transition:"pop",role:"dialog"})}function f(){var a;for(a=0;oa>a;a+=1)ca[a]||(O[a]=P[a],R[a]=S[a],U[a]=V[a]);if(1!==ua&&!aa)for(ka>la?(0>X&&Z>ka/15&&(ca[4]=!ca[4],$("#img_lock4").toggle()),X>0&&Z>ka/15&&(ca[1]=!ca[1],$("#img_lock1").toggle()),X>ka/-15&&ka/15>X&&Z>ka/-15&&ka/15>Z&&(ca[2]=!ca[2],$("#img_lock2").toggle()),0>X&&ka/-15>Z&&(ca[3]=!ca[3],$("#img_lock3").toggle()),X>0&&ka/-15>Z&&(ca[0]=!ca[0],$("#img_lock0").toggle())):(0>Z&&X>ka/15&&(ca[0]=!ca[0],$("#img_lock0").toggle()),Z>0&&X>ka/15&&(ca[1]=!ca[1],$("#img_lock1").toggle()),Z>ka/-15&&ka/15>Z&&X>ka/-15&&ka/15>X&&(ca[2]=!ca[2],$("#img_lock2").toggle()),0>Z&&ka/-15>X&&(ca[3]=!ca[3],$("#img_lock3").toggle()),Z>0&&ka/-15>X&&(ca[4]=!ca[4],$("#img_lock4").toggle())),a=0;oa>a&&ca[a];a+=1)a===oa-1&&e()}function g(){var a;for(a=0;5>a;a+=1)ca[a]=!1,$("#img_lock"+a).hide()}function h(a){var b;if(X=a.clientX-za,Z=a.clientY-Aa,D.removeEventListener("mousemove",d,!1),D.removeEventListener("mouseup",i,!1),D.removeEventListener("mouseout",j,!1),!pa||!aa){for(Math.abs(X-Y)<5&&Math.abs(Z-_)<5&&pa&&(qa=!0,new Date-H<300&&f()),b=0;oa>b;b+=1)ca[b]||(O[b]=Math.round(O[b]/Math.PI*2)*Math.PI/2,R[b]=Math.round(R[b]/Math.PI*2)*Math.PI/2,U[b]=Math.round(U[b]/Math.PI*2)*Math.PI/2);aa=!0}}function i(a){h(a)}function j(a){h(a)}function k(a){var b;for(Ea.hide(),Ca.hide(),a.preventDefault(),D.addEventListener("mousemove",d,!1),D.addEventListener("mouseup",i,!1),D.addEventListener("mouseout",j,!1),Y=a.clientX-za,_=a.clientY-Aa,H=new Date,b=0;oa>b;b+=1)P[b]=O[b],S[b]=R[b],V[b]=U[b],b>0&&(Q[b]=Math.random()+.5,T[b]=Math.random()+.5,W[b]=Math.random()+.5)}function l(a){var b;if(a.preventDefault(),!pa||!aa){for(ra===!1&&pa&&(qa=!0,new Date-H<500&&(X=Y,Z=_,f())),b=0;oa>b;b+=1)ca[b]||(O[b]=Math.round(O[b]/Math.PI*2)*Math.PI/2,R[b]=Math.round(R[b]/Math.PI*2)*Math.PI/2,U[b]=Math.round(U[b]/Math.PI*2)*Math.PI/2);aa=!0}}function m(a){var b;if(ra=!0,1===a.touches.length){if(a.preventDefault(),X=a.touches[0].pageX-za,Z=a.touches[0].pageY-Aa,pa&&aa)return;for(b=0;oa>b;b+=1)ca[b]||(O[b]=P[b]+.06*(X-Y)*Q[b],R[b]=S[b]+.06*(Z-_)*T[b],U[b]=V[b]+(.06*(X-Y)*W[b]+.02*(Z-_)*W[b])/2)}}function n(a){var b;if(H=new Date,ra=!1,1===a.touches.length)for(a.preventDefault(),Ea.hide(),Ca.hide(),Y=a.touches[0].pageX-za,_=a.touches[0].pageY-Aa,H=new Date,b=0;oa>b;b+=1)P[b]=O[b],S[b]=R[b],V[b]=U[b],b>0&&(Q[b]=Math.random()+.5,T[b]=Math.random()+.5,W[b]=Math.random()+.5)}function o(a,b,c,d,e){var f=new THREE.DirectionalLight(d,e);f.position.set(a,b,c),F.add(f),f.castShadow=!0;var g=1;f.shadow.camera.left=-g,f.shadow.camera.right=g,f.shadow.camera.top=g,f.shadow.camera.bottom=-g,f.shadow.camera.near=1,f.shadow.camera.far=4,f.shadow.mapSize.width=1024,f.shadow.mapSize.height=1024,f.shadow.bias=-.005}function p(){E.aspect=window.innerWidth/window.innerHeight,E.updateProjectionMatrix(),G.setSize(window.innerWidth,window.innerHeight)}function q(){Ea.hide(),Ca.hide(),D=document.createElement("div"),document.getElementById("dice").appendChild(D),E=new THREE.PerspectiveCamera(35,window.innerWidth/window.innerHeight,1,15),E.position.set(0,0,2.2),F=new THREE.Scene;var a=function(a){if(a.lengthComputable){var b=a.loaded/a.total*100;console.log(Math.round(b,2)+"% downloaded")}},b=function(a){},c=new THREE.MTLLoader;c.setPath("./models/"),c.load("dice.mtl",function(c){c.preload();var d=new THREE.OBJLoader;d.setMaterials(c),d.setPath("./models/"),d.load("dice.obj",function(a){F.add(a),N[0]=a},a,b)}),F.add(new THREE.AmbientLight(7829367)),o(.5,1,-1,16777215,.7),o(-1,1,1,16777215,1),G=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),G.setClearColor(0,0),G.setPixelRatio(window.devicePixelRatio),G.setSize(window.innerWidth,window.innerHeight),G.gammaInput=!0,G.gammaOutput=!0,D.appendChild(G.domElement),D.addEventListener("mousedown",k,!1),D.addEventListener("touchstart",n,!1),D.addEventListener("touchmove",m,!1),D.addEventListener("touchend",l,!1),window.addEventListener("resize",p,!1)}function r(){var a,b;for(ia=0,a=0;oa>a;a+=1)N[a].rotation.y+=.05*(O[a]-N[a].rotation.y),N[a].rotation.x+=.05*(R[a]-N[a].rotation.x),N[a].rotation.z+=.05*(U[a]-N[a].rotation.z),ia=Math.max(ia,Math.abs(N[a].rotation.y-O[a])+Math.abs(N[a].rotation.x-R[a])+Math.abs(N[a].rotation.z-U[a]));if(.01>ia&&aa){for(aa=!1,b=0;2>b;b+=1)for(ga=0,da=[0,0,0,0,0,0],a=0;oa>a;a+=1)I=(Math.round(R[a]%(2*Math.PI)/Math.PI*2)+4)%4,J=(Math.round(O[a]%(2*Math.PI)/Math.PI*2)+4)%4,K=(Math.round(U[a]%(2*Math.PI)/Math.PI*2)+4)%4,ba[a]=0,0===I&&0===J||2===I&&2===J?ba[a]=1:3===I&&1===K||1===I&&3===K||0===I&&1===J&&0===K||2===I&&3===J&&0===K||2===I&&1===J&&2===K||0===I&&3===J&&2===K?ba[a]=2:3===I&&0===K||1===I&&2===K||0===I&&1===J&&3===K||0===I&&3===J&&1===K||2===I&&1===J&&1===K||2===I&&3===J&&3===K?ba[a]=3:1===I&&0===K||3===I&&2===K||0===I&&3===J&&3===K||2===I&&1===J&&3===K||0===I&&1===J&&1===K||2===I&&3===J&&1===K?ba[a]=4:3===I&&3===K||1===I&&1===K||0===I&&3===J&&0===K||2===I&&3===J&&2===K||0===I&&1===J&&2===K||2===I&&1===J&&0===K?ba[a]=5:(0===I&&2===J||2===I&&0===J)&&(ba[a]=6),ga+=ba[a],da[ba[a]-1]=da[ba[a]-1]+1;pa?(wa||1!==ua||qa||(Qa.popup("open"),Na.mousedown(function(a){$(this).off("mousedown"),Qa.popup("close"),k(a)}),Na.mouseup(function(a){$(this).off("mouseup"),i(a)}),wa=!0),qa?qa=!1:ua+=1,Ca.html(ua+" / 3"),Ca.show(),Ea.html(document.webL10n.get("lb_player")+" "+ta),ua>3&&e()):Ea.html(ga),Ea.show()}G.render(F,E)}function s(){na&&(window.requestAnimationFrame(s),r())}function t(){var a;for(Va.stop(),na=!1,Ea.hide(),Ca.hide(),La.show(),$("#grp_anz").hide(),g(),$.mobile.changePage("#title",{transition:"slide",reverse:!0}),a=0;oa>a;a+=1)N[a].rotation.y=O[a],N[a].rotation.x=R[a],N[a].rotation.z=U[a];aa=!1}function u(){Va.start(),na=!0,s(),ya?(ya=!1,t()):$.mobile.changePage("#dice",{transition:"pop",reverse:!0})}function v(a){var b,c=!1;for(fa[ta-1][a]=ea[a],$("#lb_"+a+"p"+ta).html(ea[a]),ga=0,b=0;b<ea.length;b+=1)$("#bt_"+b+"p"+ta).css("display","none"),$("#lb_"+b+"p"+ta).css("display","inline"),ga+=fa[ta-1][b],5===b&&($("#lb_sum1p"+ta).html(ga),ga>=63&&($("#lb_bonus_p"+ta).html(35),ga+=35),ha=ga,$("#lb_sum2p"+ta).html(ga));for($("#lb_sum3p"+ta).html(ga-ha),$("#lb_sum4p"+ta).html(ga),ma[ta-1]=ga,Ka.show(),b=0;b<ea.length;b+=1)null===fa[ta-1][b]&&6!==b&&(c=!0);c||ta!==sa?(ta+=1,ta>sa&&(ta=1),ua=1,Ca.html(ua+" / 3"),Ea.html(document.webL10n.get("lb_player")+" "+ta),g(),u()):(b=ma.indexOf(Math.max.apply(Math,ma)),Ta.html(document.webL10n.get("lb_player")+" "+(b+1)+" "+document.webL10n.get("lb_win")),Ua.html(document.webL10n.get("lb_with")+" "+ma[b]+" "+document.webL10n.get("lb_pts")),Sa.popup("open"),ya=!0)}function w(){var a,b,c;for(a=0;14>a;a+=1)for(ea[a]=0,b=0;5>b;b+=1)fa[b][a]=null,$("#bt_"+a+"p"+(b+1)).css("display","none"),c=$("#lb_"+a+"p"+(b+1)),c.css("display","inline"),c.html("");for(b=0;5>b;b+=1)sa>b?($("#img_p"+(b+1)).attr("style","width:100%; background-color: #CC002F;"),$("#lb_sum1p"+(b+1)).html(0),$("#lb_sum2p"+(b+1)).html(0),$("#lb_sum3p"+(b+1)).html(0),$("#lb_sum4p"+(b+1)).html(0)):($("#img_p"+(b+1)).attr("style","width:100%; background-color: #AAAAAA;"),$("#lb_sum1p"+(b+1)).html(""),$("#lb_sum2p"+(b+1)).html(""),$("#lb_sum3p"+(b+1)).html(""),$("#lb_sum4p"+(b+1)).html("")),$("#lb_bonus_p"+(b+1)).html(""),ma[b]=0;ta=1,ua=1,g(),Ea.html(document.webL10n.get("lb_player")+" "+ta),Ca.html(ua+" / 3"),Ea.show(),Ca.show()}function x(a){pa=a,Ba.html(pa?document.webL10n.get("lb_anz_pl"):document.webL10n.get("lb_anz")),La.slideToggle(),setTimeout(function(){$("#grp_anz").slideToggle()},500)}function y(a){N[a]=N[0].clone(),N[a].rotation.y=-Math.PI/2,O[a]=Math.round((O[a]+30*Math.random()-15)/Math.PI*2)*Math.PI/2,R[a]=Math.round((R[a]+30*Math.random()-15)/Math.PI*2)*Math.PI/2,U[a]=Math.round((U[a]+30*Math.random()-15)/Math.PI*2)*Math.PI/2,N[a].rotation.y=O[a],N[a].rotation.x=R[a],N[a].rotation.z=U[a]}function z(a){var b;if(a>oa)for(b=oa;a>b;b+=1)(void 0===N[b]||null===N[b])&&y(b),F.add(N[b]);if(oa>a)for(b=a;oa>b;b+=1)F.remove(N[b]);oa=a,c()}function A(){c(),$.mobile.changePage("#title",{transition:"pop",reverse:!0})}function B(a){var b=[[[.75,0,.07],[1,1,1]],[[.09,.2,.55],[1,1,1]],[[.9,.5,.005],[1,1,1]],[[.017,.292,.243],[1,1,1]],[[.65,.65,.65],[.06,.06,.06]]],c=$("input:radio[name=color]:checked");na=!0,pa?(sa=a,z(5),$("input:radio[name=anzahl]").filter("[value=5]").prop("checked",!0),A(),w(),Da.show()):(z(a),Ea.hide(),Ca.hide(),Da.hide(),g()),Va.start(),s(),$.mobile.changePage("#dice",{transition:"slide"}),N[0].children[0].material[0].color.setRGB(b[parseInt(c.val())][0][0],b[parseInt(c.val())][0][1],b[parseInt(c.val())][0][2]),N[0].children[0].material[1].color.setRGB(b[parseInt(c.val())][1][0],b[parseInt(c.val())][1][1],b[parseInt(c.val())][1][2])}function C(a){Ta.html(document.webL10n.get(a)),Ua.html(document.webL10n.get(a+"_txt")),Sa.popup("open")}var D,E,F,G,H,I,J,K,L,M=!1,N=[],O=[0,0,0,0,0],P=[0,0,0,0,0],Q=[1,0,0,0,0],R=[0,0,0,0,0],S=[0,0,0,0,0],T=[1,0,0,0,0],U=[0,0,0,0,0],V=[0,0,0,0,0],W=[1,0,0,0,0],X=0,Y=0,Z=0,_=0,aa=!1,ba=[0,0,0,0,0],ca=[!1,!1,!1,!1,!1],da=[0,0,0,0,0,0],ea=[],fa=[];for(L=0;5>L;L+=1)fa[L]=[];var ga,ha,ia,ja,ka,la,ma=[0,0,0,0,0],na=!1,oa=1,pa=!0,qa=!1,ra=!1,sa=2,ta=1,ua=1,va=!1,wa=!1,xa=!1,ya=!1,za=window.innerWidth/2,Aa=window.innerHeight/2,Ba=$("#lb_anz"),Ca=$("#lb_try"),Da=$("#bt_list"),Ea=$("#lb_tot_val"),Fa=$("#img_lock0"),Ga=$("#img_lock1"),Ha=$("#img_lock2"),Ia=$("#img_lock3"),Ja=$("#img_lock4"),Ka=$("#div_close_list"),La=$("#bt_dice_yahtzee"),Ma=$("#bt_dice"),Na=$("#dice"),Oa=$("#bt_yahtzee"),Pa=$("#popup_swipe"),Qa=$("#popup_lock"),Ra=$("#popup_web_gl"),Sa=$("#popup_help"),Ta=$("#help_tit"),Ua=$("#help_txt");"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("sw.js").then(function(a){console.log("ServiceWorker registration successful with scope: ",a.scope)},function(a){console.log("ServiceWorker registration failed: ",a)})}),Da.click(function(a){$.mobile.changePage("#popup_yahtzee",{transition:"pop",role:"dialog"}),a.preventDefault()}),$("#popup_yahtzee").mousedown(function(){Sa.popup("close")});var Va=new Shake({threshold:8,timeout:1e3});window.addEventListener("shake",b,!1),$(document).on("pageshow","#dice",function(){va||(Pa.popup("open"),Na.mousedown(function(a){$(this).off("mousedown"),Pa.popup("close"),k(a)}),Na.mouseup(function(a){$(this).off("mouseup"),i(a)}),va=!0),c(),setTimeout(function(){c()},500)}),$(document).on("pageshow","#popup_yahtzee",function(){Va.stop(),na=!1,xa||(Ta.html(document.webL10n.get("lb_help")),Ua.html(""),Sa.popup("open"),xa=!0),c()}),Detector.webgl?q():setTimeout(function(){Ra.popup("open")},500),c(),setTimeout(function(){c()},500),$("#bt_quit").click(function(a){t(),a.preventDefault()}),$("#bt_close_list").click(function(a){u(),a.preventDefault()}),$("[id^=bt_0p]").click(function(a){v(0),a.preventDefault()}),$("[id^=bt_1p]").click(function(a){v(1),a.preventDefault()}),$("[id^=bt_2p]").click(function(a){v(2),a.preventDefault()}),$("[id^=bt_3p]").click(function(a){v(3),a.preventDefault()}),$("[id^=bt_4p]").click(function(a){v(4),a.preventDefault()}),$("[id^=bt_5p]").click(function(a){v(5),a.preventDefault()}),$("[id^=bt_7p]").click(function(a){v(7),a.preventDefault()}),$("[id^=bt_8p]").click(function(a){v(8),a.preventDefault()}),$("[id^=bt_9p]").click(function(a){v(9),a.preventDefault()}),$("[id^=bt_10p]").click(function(a){v(10),a.preventDefault()}),$("[id^=bt_11p]").click(function(a){v(11),a.preventDefault()}),$("[id^=bt_12p]").click(function(a){v(12),a.preventDefault()}),$("[id^=bt_13p]").click(function(a){v(13),a.preventDefault()}),$(window).resize(function(){c(),setTimeout(function(){c()},500)}),Ma.click(function(a){x(!1),a.preventDefault()}),Oa.click(function(a){x(!0),a.preventDefault()}),$("#bt_closeSettings").click(function(a){A(),a.preventDefault()}),$("[id^=bt_anz]").click(function(a){B(Number($(this).attr("id").slice(-1))),a.preventDefault()}),$(".help").click(function(a){C($(this).attr("id")),a.preventDefault()}),document.webL10n.ready(function(){var b=a("lang");M=!0,b&&b!==document.webL10n.getLanguage()&&(document.webL10n.setLanguage(b),M=!1)}),document.addEventListener("localized",function(){M&&($("html").attr("lang",document.webL10n.getLanguage().substr(0,2)),$("meta[name=description]").attr("content",document.webL10n.get("lb_desc")),$("link[rel=manifest]").attr("href","manifest/appmanifest_"+document.webL10n.getLanguage().substr(0,2)+".json")),M=!0})}();